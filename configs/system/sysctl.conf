# HashData Lightning 2.0 系统内核参数配置
# 作者: Vance Chen
# 这些参数将被追加到 /etc/sysctl.conf

################################################
# 共享内存配置
################################################

# 共享内存段最大大小 (字节)
kernel.shmmax = 500000000

# 系统级别的共享内存段总数
kernel.shmall = 4000000000

# 单个共享内存段的最大大小 (页)
kernel.shmmni = 4096

################################################
# 信号量配置
################################################

# 信号量配置: semmsl semmns semopm semmni
kernel.sem = 250 512000 100 2048

################################################
# 网络配置
################################################

# TCP 连接队列大小
net.core.somaxconn = 10000

# 网络接收缓冲区大小
net.core.netdev_max_backlog = 10000

# TCP 读缓冲区
net.core.rmem_default = 262144
net.core.rmem_max = 134217728

# TCP 写缓冲区
net.core.wmem_default = 262144
net.core.wmem_max = 134217728

# TCP 缓冲区自动调整
net.ipv4.tcp_rmem = 8192 87380 134217728
net.ipv4.tcp_wmem = 8192 65536 134217728

# TCP 连接超时
net.ipv4.tcp_fin_timeout = 5

# 启用 TCP 窗口缩放
net.ipv4.tcp_window_scaling = 1

# 启用 TCP 时间戳
net.ipv4.tcp_timestamps = 1

# 启用选择性应答
net.ipv4.tcp_sack = 1

################################################
# 虚拟内存配置
################################################

# 虚拟内存使用比例
vm.swappiness = 10

# 脏页比例
vm.dirty_background_ratio = 3
vm.dirty_ratio = 15

# 脏页过期时间 (厘秒)
vm.dirty_expire_centisecs = 500

# 脏页回写间隔 (厘秒)
vm.dirty_writeback_centisecs = 100

# 内存过量提交
vm.overcommit_memory = 2
vm.overcommit_ratio = 95

################################################
# 文件系统配置
################################################

# 文件描述符限制
fs.file-max = 65536

# inode 和文件缓存回收
vm.vfs_cache_pressure = 50 